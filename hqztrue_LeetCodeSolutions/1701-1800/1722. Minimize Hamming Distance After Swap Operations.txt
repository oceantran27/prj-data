find connected components, and greedily match within each connected components. O(n+m).

