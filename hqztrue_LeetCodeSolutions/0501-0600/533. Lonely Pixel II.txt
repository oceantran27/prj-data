we can use trie for rows. O(n^2).
