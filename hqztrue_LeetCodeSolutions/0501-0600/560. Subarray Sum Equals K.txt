prefix sum, hashing. O(n).
