prefix sum, hashing (bucket). O(n).
