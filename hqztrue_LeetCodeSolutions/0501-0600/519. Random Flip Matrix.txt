hashing+rejection sampling. expected O(1) per operation.

