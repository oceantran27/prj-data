shortest path + topological sort. O(n+m) \cite{thorup1999undirected}.

