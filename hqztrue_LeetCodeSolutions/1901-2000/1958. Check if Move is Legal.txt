O(n+m) after reading the input.

