See 3036. Number of Subarrays That Match a Pattern II.

