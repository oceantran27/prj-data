kmp. O(n). See 3006. Find Beautiful Indices in the Given Array I.

