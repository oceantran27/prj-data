prefix sum and suffix sum. O(n).

