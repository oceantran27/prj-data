binary search. O(L+|Î£| log n).

