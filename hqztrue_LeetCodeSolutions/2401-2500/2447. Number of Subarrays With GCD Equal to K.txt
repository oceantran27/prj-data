two pointers, use ST or double-ended queue (implement by two stacks) to maintain. O(n log n+n log U).

