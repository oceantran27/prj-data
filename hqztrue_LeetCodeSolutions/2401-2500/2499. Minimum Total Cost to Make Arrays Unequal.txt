greedy, case analysis. O(n).

