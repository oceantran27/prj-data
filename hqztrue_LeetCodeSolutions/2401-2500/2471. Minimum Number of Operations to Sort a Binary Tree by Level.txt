dfs+permutation cycle. O(n).

