simulation. O(n log U) (n*the running time for reversal).

