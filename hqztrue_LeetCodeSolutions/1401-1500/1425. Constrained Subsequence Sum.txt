DP, monotone array. O(n).
