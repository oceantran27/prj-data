bfs, for each route create a new super node (or hyperedge). O(n).

