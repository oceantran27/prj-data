dfs. O(#output).
The size of output is n^{O(1)}.

