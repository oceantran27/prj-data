separate the variables, then counting inversions. O(n*\sqrt{\log n}) \cite{chan2010counting}.

