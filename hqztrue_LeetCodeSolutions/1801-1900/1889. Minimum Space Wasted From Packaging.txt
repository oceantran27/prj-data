sorting, prefix sum. O(sort(n)).

