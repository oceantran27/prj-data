Topological sort. O(n+m).
