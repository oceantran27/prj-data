DP, there are O(1) states, use matrix multiplication+fast exponentiation. O(log n).
