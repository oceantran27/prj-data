dfs. O(n).

can do O(1) space.
