use dfs to construct the connectivity graph. O(L).

