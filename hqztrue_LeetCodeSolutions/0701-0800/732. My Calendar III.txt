segment tree (balanced tree). O(n log n).

