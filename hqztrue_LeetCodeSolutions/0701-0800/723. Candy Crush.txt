simulation. O(n^2 m).

better running time?

