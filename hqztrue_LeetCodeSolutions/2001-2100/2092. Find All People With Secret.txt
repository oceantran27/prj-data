bfs. O(n+sort(m)).

