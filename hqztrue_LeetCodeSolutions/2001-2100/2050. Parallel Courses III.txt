DP on DAG. O(n+m).

