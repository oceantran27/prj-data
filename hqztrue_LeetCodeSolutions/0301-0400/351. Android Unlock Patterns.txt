dfs/DP with state compression.
