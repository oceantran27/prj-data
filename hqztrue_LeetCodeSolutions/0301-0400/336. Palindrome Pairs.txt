sort all strings according to length, by radix sort in O(n). wlog only consider a shorter string is connected after a longer string. let the current shorter string be s, assume all strings longer than s are inserted in a trie. when we insert a string to the trie, first for each suffix of it, determine whether it's a palindrome in linear time, and if it is, record in the corresponding node in the trie. when we query the reverse of s, use the information on the trie node, which is linear in the number of solutions related to s. finally remove duplicate pairs (i,j) and (j,i) by radix sort. total time O(L+#solutions).

