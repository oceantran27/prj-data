bfs from leaves. O(n).
