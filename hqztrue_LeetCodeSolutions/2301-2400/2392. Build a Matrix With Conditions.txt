topological sort. O(n+m+k^2).

