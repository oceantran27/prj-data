DP on the tree. O(n).

