dfs. O(n+m).

remark. this problem has inevitable precision issues.

