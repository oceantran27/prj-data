greedy. O(sort(nm)) or O(nm log m).

