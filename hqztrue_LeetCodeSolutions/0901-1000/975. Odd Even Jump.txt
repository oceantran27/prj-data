Sorting + monotone queue. O(n).

