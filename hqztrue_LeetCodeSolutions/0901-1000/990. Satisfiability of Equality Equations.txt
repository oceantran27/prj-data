offline union find, use dfs. O(n).
