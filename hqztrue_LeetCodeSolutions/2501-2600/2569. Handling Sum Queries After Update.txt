segment tree. O(n+q log n).

