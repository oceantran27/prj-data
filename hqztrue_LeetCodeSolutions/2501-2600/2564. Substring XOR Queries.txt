O(n log U).

faster algorithms?

