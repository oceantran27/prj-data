factoring. O(n+U) (improvable when U>>n).

