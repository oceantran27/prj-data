dfs. O(1) per update, O(n) per query.

