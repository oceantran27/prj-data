DP. O(n*sqrt(n)).

