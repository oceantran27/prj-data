O(L+sort(n)/n) for upload using priority queue, O(L) for watch and O(1) for other operations.

