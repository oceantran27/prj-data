bfs on cactus. O(n).

