DP, monotonic queue. O(n).
