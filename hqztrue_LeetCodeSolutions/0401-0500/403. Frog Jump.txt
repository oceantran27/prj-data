dfs with memoization. O(n^2).
