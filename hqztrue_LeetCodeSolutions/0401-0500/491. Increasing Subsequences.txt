DP, use segment tree. need to remove the duplicates. O(n log n).
